#[macro_use]
extern crate lazy_static;
extern crate regex;

use regex::Regex;

lazy_static! {
    /// Regular expression for IPv4Address.
    /// # Example:
    /// ```
    /// use regexp;
    /// println!("{}", regexp::IP_V4_ADDR.is_match("0.0.0.0"));
    /// ```
    pub static ref IP_V4_ADDR: Regex = Regex::new(
        r"(?x)
        ^
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        $
        "
    )
    .unwrap();
}

lazy_static! {
    /// Regular expression for IPv6Address.
    /// # Example:
    /// ```
    /// use regexp;
    /// println!("{}", regexp::IP_V6_ADDR.is_match("::"));
    /// ```
    pub static ref IP_V6_ADDR: Regex = Regex::new(
        r"(?x)
        ^
        (?:
        (?:[\dA-Fa-f]{1,4}:){6}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        ::
        (?:
        (?:
        [\dA-Fa-f]{1,4}:){5}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        [\dA-Fa-f]{1,4}?
        ::
        (?:
        (?:
        [\dA-Fa-f]{1,4}:){4}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,1}
        [\dA-Fa-f]{1,4}
        )?
        ::
        (?:
        (?:
        [\dA-Fa-f]{1,4}:){3}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,2}
        [\dA-Fa-f]{1,4}
        )?
        ::
        (?:
        (?:
        [\dA-Fa-f]{1,4}:){2}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,3}
        [\dA-Fa-f]{1,4}?
        :)?
        ::
        (?:
        (?:
        [\dA-Fa-f]{1,4}:){1}
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        )
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,4}
        [\dA-Fa-f]{1,4}
        )?
        ::
        (?:
        [\dA-Fa-f]{1,4}:[\dA-Fa-f]{1,4}
        |
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        \.
        (?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)
        )
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,5}
        [\dA-Fa-f]{1,4}
        )?
        ::
        [\dA-Fa-f]{1,4}
        |
        (?:
        (?:[\dA-Fa-f]{1,4}:){0,6}
        [\dA-Fa-f]{1,4}
        )?
        ::
        $"
    )
    .unwrap();
}
